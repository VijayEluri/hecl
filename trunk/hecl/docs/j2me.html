<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Hecl and J2ME</title><link rel="stylesheet" href="hecl.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.71.0"><link rel="start" href="index.html" title="Hecl Programming Language"><link rel="up" href="index.html" title="Hecl Programming Language"><link rel="prev" href="heclandjava.html" title="Interfacing Hecl and Java"><link rel="next" href="alert.html" title="alert"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Hecl and J2ME</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="heclandjava.html"><img src="images/prev.png" alt="Prev"></a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="alert.html"><img src="images/next.png" alt="Next"></a></td></tr></table></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="j2me"></a>Hecl and J2ME</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="j2me.html#j2mecommands">Hecl J2ME Commands</a></span></dt><dt><span class="section"><a href="j2me.html#heclapps">Creating your own Hecl J2ME apps</a></span></dt><dt><span class="section"><a href="j2me.html#id2551268">Example application</a></span></dt><dt><span class="section"><a href="j2me.html#id2551394">Hacking Hecl's J2ME code</a></span></dt></dl></div><p>
      Hecl is designed to be small enough to run on mobile devices
      such as cell phones.  This means that for the Hecl core, has
      been necessary to limit ourselves to Java API's that work with
      J2ME.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="j2mecommands"></a>Hecl J2ME Commands</h3></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="alert.html">alert</a></span><span class="refpurpose"> &#8212; Creates an alert</span></dt><dt><span class="refentrytitle"><a href="choicegroup.html">choicegroup</a></span><span class="refpurpose"> &#8212; Displays a choicegroup in the current form</span></dt><dt><span class="refentrytitle"><a href="cmd.html">cmd</a></span><span class="refpurpose"> &#8212; Adds a command to a form/listbox/textbox</span></dt><dt><span class="refentrytitle"><a href="datefield.html">datefield</a></span><span class="refpurpose"> &#8212; Displays an datefield in the current form</span></dt><dt><span class="refentrytitle"><a href="j2me_exit.html">exit</a></span><span class="refpurpose"> &#8212; Exits the application</span></dt><dt><span class="refentrytitle"><a href="form.html">form</a></span><span class="refpurpose"> &#8212; Creates a form</span></dt><dt><span class="refentrytitle"><a href="gauge.html">gauge</a></span><span class="refpurpose"> &#8212; Displays an gauge in the current form</span></dt><dt><span class="refentrytitle"><a href="getindex.html">getindex</a></span><span class="refpurpose"> &#8212; Fetches a reference to the N'th element in a
	  given form/listbox</span></dt><dt><span class="refentrytitle"><a href="getprop.html">getprop</a></span><span class="refpurpose"> &#8212; Fetches the value of a given property from a widget</span></dt><dt><span class="refentrytitle"><a href="listbox.html">listbox</a></span><span class="refpurpose"> &#8212; Creates a listbox</span></dt><dt><span class="refentrytitle"><a href="noscreen.html">noscreen</a></span><span class="refpurpose"> &#8212; Runs without a current screen widget</span></dt><dt><span class="refentrytitle"><a href="screenappend.html">screenappend</a></span><span class="refpurpose"> &#8212; Appends an item to a form or listbox</span></dt><dt><span class="refentrytitle"><a href="setcurrent.html">setcurrent</a></span><span class="refpurpose"> &#8212; Displays an alert/form/listbox/textbox</span></dt><dt><span class="refentrytitle"><a href="setindex.html">setindex</a></span><span class="refpurpose"> &#8212; 
	    Sets the
	    <code class="option"><em class="replaceable"><code>index</code></em></code>th
	    element in a form/listbox to specified item</span></dt><dt><span class="refentrytitle"><a href="setprop.html">setprop</a></span><span class="refpurpose"> &#8212; Sets a given property of a widget</span></dt><dt><span class="refentrytitle"><a href="string.html">string</a></span><span class="refpurpose"> &#8212; Adds a string to the current form.</span></dt><dt><span class="refentrytitle"><a href="stringitem.html">stringitem</a></span><span class="refpurpose"> &#8212; Displays a stringitem in the current form</span></dt><dt><span class="refentrytitle"><a href="textbox.html">textbox</a></span><span class="refpurpose"> &#8212; Creates a textbox</span></dt><dt><span class="refentrytitle"><a href="textfield.html">textfield</a></span><span class="refpurpose"> &#8212; Displays a textfield in the current form</span></dt></dl></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
	Hecl has different GUI commands for the MIDP1.0 (older phones)
	and MIDP2.0 (newer, with more memory).  We are in the process
	of documenting the MIDP2.0 commands.
      </td></tr></table></div><p>
	Commands available in the J2ME MIDP1.0 version of Hecl to
	interact with the phone.  Look in the
	<code class="filename">midp10/examples</code> directory for examples of
	these commands and widgets in use.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="heclapps"></a>Creating your own Hecl J2ME apps</h3></div></div></div><p>
	Creating new hecl applications is relatively easy using the
	<span class="application">HeclBuilder</span> application.
      </p><div class="procedure"><ol type="1"><li><p>
	    Launch it like so:
	  </p><pre class="screen">java -jar jars/HeclBuilder.jar</pre><p>
	    It should look something like this:
	  </p><div class="screenshot"><div class="mediaobject"><img src="heclbuilder-screen.png"><div class="caption">
		HeclBuilder in action
	      </div></div></div></li><li><p>
	    First, you must select a script to use for your Hecl
	    application.  We recommend that you create this yourself
	    using your favorite editor (if it has a Tcl mode, that
	    will make things even easier).  The provided editor is not
	    yet really worthy of the name!
	  </p></li><li><p>
	    The next field (<span class="guilabel">MIDlet name</span>) is the
	    name of your Hecl application.  This will be used both as
	    the name visible on the cell phone, as well as the name of
	    the .jar file.
	  </p></li><li><p>
	    Select a directory where the resulting .jar and .jad files
	    will be placed.
	  </p></li><li><p>
	    At this point, all you have to do is press the "Go"
	    button, and the .jar and .jad files will be created for
	    you.  All that's left is to move them on to the cell
	    phone, but we can't do that for you, as there is no
	    standard method - each phone manufacturer provides their
	    own way.  On Linux, I use the following command:
	  </p><pre class="screen">gammu nothing --nokiaaddfile Application Hecl</pre></li><li><p>
	    If you have some sort of J2ME SDK that includes an
	    emulator, now would be a good time to try out your
	    application before running it on your phone.  You can get
	    that is free (if not open source) from Sun here: <a href="http://java.sun.com/products/sjwtoolkit/" target="_top">http://java.sun.com/products/sjwtoolkit/</a>
	    .  I run it like this:
	  </p><pre class="screen">~/Desktop/WTK2.2/bin/emulator -classpath MyApp.jar Hecl</pre><p>
	    Note that <code class="option">Hecl</code> above will not change,
	    because that is always the main class, even if the
	    application itself has a different name.
	  </p></li></ol></div><p>
	This leads to a very quick development cycle - if you leave
	HeclBuilder open, all you have to do to update your .jar and
	.jad files after you have edited your Hecl script, is to click
	the <span class="guibutton">Create .jar/.jad files</span> button!
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2551268"></a>Example application</h3></div></div></div><p>
	For example, let's create a simple form with a text entry
	widget and a command that acts on it:
      </p><pre class="programlisting">proc reverse {tf results} {
    set string [getprop $tf text]
    set newstring ""
    set i [slen $string]
    incr $i -1
    while {&gt; $i -1} {
	set c [sindex $string $i]
	append $newstring $c
	incr $i -1
    }
    setprop $results text $newstring
}

set mainform [form label "Reverse a String" code {
    set tf [textfield label "String:"]
    set results [stringitem label "Results:"]
    cmd label "Reverse" code [list reverse $tf $results]
    cmd label "Exit" code exit type exit;
}]

setcurrent $mainform
</pre><p>
	This program is pretty simple.  It displays a form, which
	contains a textfield and a stringitem, and two commands,
	<span><strong class="command">Reverse</strong></span> and <span><strong class="command">Exit</strong></span>.  When
	you select <span><strong class="command">Reverse</strong></span>, the text contained in
	the textfield is reversed, and displayed in the stringitem.
	Exit does what you might expect.
      </p><p>
	The code is fairly self-explanatory, with a few key points
	worth noting.  Within the <span><strong class="command">reverse</strong></span> proc,
	<span><strong class="command">getprop</strong></span> and <span><strong class="command">setprop</strong></span> are
	used to fetch and set properties of the textfield and
	stringitem.  All the GUI elements have fairly similar
	arguments, for instance <code class="option">label</code> for the label,
	and <code class="option">code</code> for the code associated with them.
	Note thouth that the code associated with the form is
	evaluated immediately, whereas that associated with the
	commands is only evaluated when they are selected.  Lastly, to
	actually display this on the screen, it's necessary to set the
	form as the screen item currently displayed.
      </p><p>The program looks more or less like this when run:

      </p><div class="screenshot"><div class="mediaobject"><img src="reverse-screen.png"><div class="caption">
	    "reverse" screenshot, with textfield, stringitem, and two
	    commands, Reverse and Exit
	  </div></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="id2551394"></a>Hacking Hecl's J2ME code</h3></div></div></div><p>
	Should you need to "look under the hood" (and you are
	encouraged to do so!), everything you need is in the
	<code class="filename">midp10/</code> directory.  The
	<code class="filename">GUICmds.java</code> file contains most of the
	functionality that maps J2ME functionality to Hecl and back.
	The <code class="filename">Hecl.java</code> file contains the code that
	starts up Hecl on the cell phone.
      </p><p>
	If you want to recompile the standard Hecl.jar and .jad,
	simply use the <span><strong class="command">ant midlet10</strong></span> command (or
	<span><strong class="command">ant midlet11</strong></span> if you want the CLDC1.1
	version of Hecl) to create the .jar and .jad files for you,
	including your version of script.hcl.
      </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="heclandjava.html"><img src="images/prev.png" alt="Prev"></a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="alert.html"><img src="images/next.png" alt="Next"></a></td></tr><tr><td width="40%" align="left" valign="top">Interfacing Hecl and Java </td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.png" alt="Home"></a></td><td width="40%" align="right" valign="top"> alert</td></tr></table></div></body></html>
