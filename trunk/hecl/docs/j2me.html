<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Hecl and J2ME</title><link rel="stylesheet" href="hecl.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.68.1"><link rel="start" href="index.html" title="
      
	Hecl Programming Language
      
    "><link rel="up" href="index.html" title="
      
	Hecl Programming Language
      
    "><link rel="prev" href="heclandjava.html" title="Interfacing Hecl and Java"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Hecl and J2ME</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="heclandjava.html"><img src="images/prev.png" alt="Prev"></a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> </td></tr></table></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="j2me"></a>Hecl and J2ME</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="j2me.html#j2mecommands">Hecl J2ME Commands</a></span></dt><dt><span class="section"><a href="j2me.html#heclapps">Creating your own Hecl apps</a></span></dt></dl></div><p>
      Hecl is designed to be small enough to run on mobile devices
      such as cell phones.  This means that for the Hecl core, has
      been necessary to limit ourselves to Java API's that work with
      J2ME.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="j2mecommands"></a>Hecl J2ME Commands</h3></div></div></div><p>
	Commands available in the J2ME version of Hecl to interact
	with the phone.  FIXME: more soon!
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="heclapps"></a>Creating your own Hecl apps</h3></div></div></div><p>
	Creating new hecl applications is relatively easy.  Everything
	you need is in the <code class="filename">j2me/</code> directory.  The
	<code class="filename">GUICmds.java</code> file contains most of the
	functionality that maps J2ME functionality to Hecl and back.
	The <code class="filename">Hecl.java</code> file contains the code that
	starts up Hecl on the cell phone.
      </p><p>
	If you are just looking to write an application, though, the
	most important file is <code class="filename">script.hcl</code>, which
	is what gets loaded up and executed at runtime.  The sample
	application contained therein is a good guide to how to make
	your own apps.  If you want to modify it, make a backup copy
	for use as a reference, and then get started!
      </p><div class="procedure"><ol type="1"><li><p>
	    If you are interested in recompiling the Hecl J2ME Java
	    files, change the <code class="varname">j2mebootclasspath</code>
	    variable in the <code class="filename">build.xml</code> Ant build
	    file.  To compile, you can then run <span><strong class="command">ant
	    packageJ2ME</strong></span> from the hecl directory.
	  </p></li><li><p>
	    If you have recompiled the J2ME java files, you can simply
	    use the <span><strong class="command">ant J2ME</strong></span> command to create the
	    .jar and .jad files for you, including your version of
	    script.hcl.
	  </p><p>
	    Otherwise, it's still pretty easy.  Once you've finished
	    editing <code class="filename">script.hcl</code>, update the jar
	    file with your new copy:
	    </p><pre class="programlisting">jar uf Hecl.jar script.hcl</pre><p>
	    Then, make sure to update the .jad so that it has the
	    correct size for the .jar file.  You can do this
	    automatically with a Hecl script:
	    </p><pre class="programlisting">java -jar ../Hecl.jar updatejad.hcl \
	    Hecl.jad Hecl.jar</pre><p>
	  </p></li></ol></div><p>
	For example, let's create a simple form with a text entry
	widget and a command that acts on it:
      </p><pre class="programlisting">proc reverse {tf results} {
    set string [getprop &amp;tf text]
    set newstring ""
    set i [slen &amp;string]
    incr &amp;i -1
    while {&gt; &amp;i -1} {
	set c [sindex &amp;string &amp;i]
	append &amp;newstring &amp;c
	incr &amp;i -1
    }
    setprop &amp;results text $newstring
}

set mainform [form label "Reverse a String" code {
    set tf [textfield label "String:"]
    set results [stringitem label "Results:"]
    cmd label "Reverse" code [list reverse &amp;tf &amp;results]
    cmd label "Exit" code exit type exit;
}]

setcurrent $mainform
</pre><p>
	This program is pretty simple.  It displays a form, which
	contains a textfield and a stringitem, and two commands,
	<span><strong class="command">Reverse</strong></span> and <span><strong class="command">Exit</strong></span>.  When
	you select <span><strong class="command">Reverse</strong></span>, the text contained in
	the textfield is reversed, and displayed in the stringitem.
	Exit does what you might expect.
      </p><p>
	The code is fairly self-explanatory, with a few key points
	worth noting.  Within the <span><strong class="command">reverse</strong></span> proc,
	<span><strong class="command">getprop</strong></span> and <span><strong class="command">setprop</strong></span> are
	used to fetch and set properties of the textfield and
	stringitem.  All the GUI elements have fairly similar
	arguments, for instance <code class="option">label</code> for the label,
	and <code class="option">code</code> for the code associated with them.
	Note thouth that the code associated with the form is
	evaluated immediately, whereas that associated with the
	commands is only evaluated when they are selected.  Lastly, to
	actually display this on the screen, it's necessary to set the
	form as the screen item currently displayed.
      </p><p>The program looks more or less like this when run:

      </p><div class="figure"><a name="id2516603"></a><p class="title"><b>Figure 1. "reverse" screen shot</b></p><div class="mediaobject"><img src="reverse-screen.png" alt='"reverse" screenshot, with textfield,
	      stringitem, and two commands, Reverse and Exit'></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="heclandjava.html"><img src="images/prev.png" alt="Prev"></a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> </td></tr><tr><td width="40%" align="left" valign="top">Interfacing Hecl and Java </td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.png" alt="Home"></a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>
